<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NovaSearch</title>
  <link rel="manifest" href="manifest.json" />
  <style>
    :root {
      --bg-color: #0a0a23;
      --text-color: #ffffff;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      overflow: hidden;
      transition: background 0.4s, color 0.4s;
    }

    header {
      text-align: center;
      padding: 20px;
      z-index: 2;
    }

    header img {
      height: 60px;
      border-radius: 50%;
      margin-bottom: 10px;
    }

    h1 {
      font-size: 2.5rem;
      margin: 0;
    }

    .search-box {
      margin: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      z-index: 2;
    }

    input[type="text"], select, button {
      padding: 10px;
      width: 80vw;
      max-width: 400px;
      font-size: 1rem;
      border-radius: 8px;
      border: none;
      margin: 5px;
    }

    button {
      background-color: #ffffff22;
      color: var(--text-color);
      cursor: pointer;
    }

    button:hover, select:hover {
      background-color: #ffffff44;
    }

    .result {
      max-width: 700px;
      padding: 20px;
      text-align: left;
      z-index: 2;
      background-color: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
      margin: 20px;
    }

    .result img {
      max-width: 100%;
      margin-top: 10px;
      border-radius: 12px;
    }

    .theme-light { --bg-color: #ffffff; --text-color: #000000; }
    .theme-ocean { --bg-color: #0f2027; --text-color: #a3d5ff; }
    .theme-sunset { --bg-color: #2c3e50; --text-color: #f39c12; }
    .theme-mint { --bg-color: #d0f0c0; --text-color: #004d00; }
    .theme-night { --bg-color: #1a1a2e; --text-color: #eaeaea; }
    .theme-ice { --bg-color: #e0f7fa; --text-color: #004d40; }

    .floating {
      position: absolute;
      pointer-events: none;
      animation: float 10s linear infinite;
      opacity: 0.7;
      font-size: 20px;
    }

    @keyframes float {
      0% { transform: translateY(100vh) scale(1); }
      100% { transform: translateY(-10vh) scale(1.2); }
    }
  </style>
</head>
<body>
  <header>
    <img src="icon-192.png" alt="NovaSearch Logo" />
    <h1>NovaSearch</h1>
  </header>

  <div class="search-box">
    <input type="text" id="query" placeholder="Search anything..." />
    <select id="category">
      <option value="web">Web</option>
      <option value="images">Images</option>
      <option value="news">News</option>
    </select>
    <button onclick="search()">Search</button>
    <button onclick="toggleVoice()">üé§ Voice Search</button>
    <select id="themeSwitcher" onchange="switchTheme()">
      <option value="">Choose Theme</option>
      <option value="theme-light">Light</option>
      <option value="theme-ocean">Ocean</option>
      <option value="theme-sunset">Sunset</option>
      <option value="theme-mint">Mint</option>
      <option value="theme-night">Night</option>
      <option value="theme-ice">Ice</option>
    </select>
    <select id="effectSwitcher" onchange="setEffect()">
      <option value="">Choose Effect</option>
      <option value="stars">Stars</option>
      <option value="hearts">Hearts</option>
      <option value="sparks">Sparks</option>
      <option value="leaves">Leaves</option>
      <option value="pixels">Pixels</option>
      <option value="snow">Snow</option>
    </select>
  </div>

  <div id="loading" style="display:none">Loading...</div>
  <div class="result" id="resultBox"></div>
  <div id="historyBox"></div>
  <div id="effect-container"></div>

  <script>
    function search() {
      const query = document.getElementById("query").value;
      const url = `https://api.duckduckgo.com/?q=${encodeURIComponent(query)}&format=json&pretty=1`;
      document.getElementById("loading").style.display = "block";
      fetch(url)
        .then(res => res.json())
        .then(data => {
          const box = document.getElementById("resultBox");
          box.innerHTML = "";
          if (data.Heading) box.innerHTML += `<h2>${data.Heading}</h2>`;
          if (data.Abstract) box.innerHTML += `<p>${data.Abstract}</p>`;
          if (data.Image) box.innerHTML += `<img src="${data.Image}" alt="Result Image" />`;
          if (!data.Heading && !data.Abstract) box.innerHTML += `<p>No results found. Try something else!</p>`;
          saveHistory(query);
          showHistory();
          document.getElementById("loading").style.display = "none";
        })
        .catch(() => {
          document.getElementById("resultBox").innerHTML = "<p>Error fetching results. Try again later.</p>";
          document.getElementById("loading").style.display = "none";
        });
    }

    function saveHistory(query) {
      let history = JSON.parse(localStorage.getItem("novaHistory")) || [];
      history.unshift(query);
      history = history.slice(0, 5);
      localStorage.setItem("novaHistory", JSON.stringify(history));
    }

    function showHistory() {
      const box = document.getElementById("historyBox");
      const history = JSON.parse(localStorage.getItem("novaHistory")) || [];
      box.innerHTML = `<h3>Recent Searches</h3><ul>${history.map(q => `<li>${q}</li>`).join("")}</ul>`;
    }

    function switchTheme() {
      const theme = document.getElementById("themeSwitcher").value;
      document.body.className = theme;
    }

    function toggleVoice() {
      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.onresult = function(event) {
        document.getElementById("query").value = event.results[0][0].transcript;
      };
      recognition.start();
    }

    function setEffect() {
      const effect = document.getElementById("effectSwitcher").value;
      const container = document.getElementById("effect-container");
      container.innerHTML = "";

      const emojis = {
        stars: "‚ú®",
        hearts: "‚ù§Ô∏è",
        sparks: "üî•",
        leaves: "üåø",
        pixels: "‚ñ†",
        snow: "‚ùÑÔ∏è"
      };

      if (emojis[effect]) {
        for (let i = 0; i < 30; i++) {
          const span = document.createElement("span");
          span.className = "floating";
          span.textContent = emojis[effect];
          span.style.left = Math.random() * 100 + "vw";
          span.style.top = Math.random() * 100 + "vh";
          span.style.animationDelay = Math.random() * 10 + "s";
          container.appendChild(span);
        }
      }
    }

    window.onload = showHistory;
  </script>
</body>
</html>
